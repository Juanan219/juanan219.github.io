<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:Juan Antonio Reifs]">
<meta name="description" content="Libvirt es una API de virtualizacion que se usa con KVM o Qemu KVM (el sistema de virtualización nativo de Linux).
Instalación Para instalar libvirt deberemos instalar los siguientes paquetes
sudo apt-get install qemu-kvm libvirt-daemon-system Explicación de los paquetes:
  qemu-kvm: Proporciona la virtualización para x86
  libvirt-daemon-system: Es el demonio de libvirt, el cual hace accesible la API a través de un socket UNIX (aunque se puede configurar para acceder a través de un socket TCP)." />
<meta name="keywords" content=", Apuntes, Documentacion, Libvirt, virsh, virtinst, kvm, qemu" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://juanan219.github.io/posts/2021/03/apuntes-de-libvirt/" />


    <title>
        
            Apuntes de Libvirt :: JuananBlog  — JuananBlog
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://juanan219.github.io/main.154a87e0ff720e102948892a8eb80881aa81a4faf37376f3093be219f6296c3d.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://juanan219.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://juanan219.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://juanan219.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://juanan219.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://juanan219.github.io/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://juanan219.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="Apuntes de Libvirt">
<meta itemprop="description" content="Libvirt es una API de virtualizacion que se usa con KVM o Qemu KVM (el sistema de virtualización nativo de Linux).
Instalación Para instalar libvirt deberemos instalar los siguientes paquetes
sudo apt-get install qemu-kvm libvirt-daemon-system Explicación de los paquetes:
  qemu-kvm: Proporciona la virtualización para x86
  libvirt-daemon-system: Es el demonio de libvirt, el cual hace accesible la API a través de un socket UNIX (aunque se puede configurar para acceder a través de un socket TCP).">
<meta itemprop="datePublished" content="2021-03-18T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-03-18T00:00:00+00:00" />
<meta itemprop="wordCount" content="3001">
<meta itemprop="image" content="https://juanan219.github.io"/>



<meta itemprop="keywords" content="Apuntes,Documentacion,Libvirt,virsh,virtinst,kvm,qemu," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://juanan219.github.io"/>

<meta name="twitter:title" content="Apuntes de Libvirt"/>
<meta name="twitter:description" content="Libvirt es una API de virtualizacion que se usa con KVM o Qemu KVM (el sistema de virtualización nativo de Linux).
Instalación Para instalar libvirt deberemos instalar los siguientes paquetes
sudo apt-get install qemu-kvm libvirt-daemon-system Explicación de los paquetes:
  qemu-kvm: Proporciona la virtualización para x86
  libvirt-daemon-system: Es el demonio de libvirt, el cual hace accesible la API a través de un socket UNIX (aunque se puede configurar para acceder a través de un socket TCP)."/>




    <meta property="og:title" content="Apuntes de Libvirt" />
<meta property="og:description" content="Libvirt es una API de virtualizacion que se usa con KVM o Qemu KVM (el sistema de virtualización nativo de Linux).
Instalación Para instalar libvirt deberemos instalar los siguientes paquetes
sudo apt-get install qemu-kvm libvirt-daemon-system Explicación de los paquetes:
  qemu-kvm: Proporciona la virtualización para x86
  libvirt-daemon-system: Es el demonio de libvirt, el cual hace accesible la API a través de un socket UNIX (aunque se puede configurar para acceder a través de un socket TCP)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://juanan219.github.io/posts/2021/03/apuntes-de-libvirt/" />
<meta property="og:image" content="https://juanan219.github.io"/>
<meta property="article:published_time" content="2021-03-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-03-18T00:00:00+00:00" />







    <meta property="article:published_time" content="2021-03-18 00:00:00 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://juanan219.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://juanan219.github.io/about/">About</a></li><li><a href="https://juanan219.github.io/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        15 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://juanan219.github.io/posts/2021/03/apuntes-de-libvirt/">Apuntes de Libvirt</a>
      </h1>

      

      

      <div class="post-content">
        <p><code>Libvirt</code> es una API de virtualizacion que se usa con <code>KVM</code> o <code>Qemu KVM</code> (el sistema de virtualización nativo de Linux).</p>
<h2 id="instalación">Instalación</h2>
<p>Para instalar <code>libvirt</code> deberemos instalar los siguientes paquetes</p>
<pre><code>sudo apt-get install qemu-kvm libvirt-daemon-system 
</code></pre><p>Explicación de los paquetes:</p>
<ul>
<li>
<p><strong><code>qemu-kvm</code>:</strong> Proporciona la virtualización para <code>x86</code></p>
</li>
<li>
<p><strong><code>libvirt-daemon-system</code>:</strong> Es el demonio de <code>libvirt</code>, el cual hace accesible la <code>API</code> a través de un <code>socket UNIX</code> (aunque se puede configurar para acceder a través de un <code>socket TCP</code>).</p>
</li>
</ul>
<p>Una vez que ya hemos realizado la instalación de estos dos paquetes, deberemos añadir a nuestro usuario personal (el usuario sin privilegios) al grupo de <code>libvirt</code>.</p>
<pre><code>sudo adduser usuario libvirt
</code></pre><p>Esta configuración se debe a que hay dos formas de usar esta API:</p>
<ul>
<li>
<p><strong><code>qemu:///session</code>:</strong> Sería el equivalente a usar el usuario sin privilegios del sistema, con lo cual tendríamos ciertas limitaciones al usar la <code>API</code>.</p>
</li>
<li>
<p><strong><code>qemu:///system</code>:</strong> Sería el equivalente a usar el usuario administrador o <code>root</code> del sistema.</p>
</li>
</ul>
<p>Por lo que si nuestro usuario no pertenece al grupo <code>libvirt</code>, no podríamos usar el comando <code>qemu:///system</code> con dicho usuario.</p>
<h2 id="definición-y-creación-de-redes-en-virsh">Definición y creación de redes en virsh</h2>
<p>Para crear objetos en <code>virsh</code> necesitamos crear ficheros <code>xml</code> en los que definimos dicha configuración.</p>
<p>Este es un dichero <code>xml</code> de creación de una red de ejemplo:</p>
<pre><code>&lt;network&gt;
 &lt;name&gt;default&lt;/name&gt;
 &lt;forward mode='nat'&gt;
  &lt;nat&gt;
   &lt;port start='1024' end='65535'/&gt;
  &lt;/nat&gt;
 &lt;/forward&gt;
 &lt;bridge name='virbr0' stp='on' delay='0'/&gt;
 &lt;ip address='192.168.122.1' netmask='255.255.255.0'&gt;
  &lt;dhcp&gt;
   &lt;range start='192.168.122.2' end='192.168.122.254'/&gt;
  &lt;/dhcp&gt;
 &lt;/ip&gt;
&lt;/network&gt;
</code></pre><ul>
<li>Tenemos un fichero <code>xml</code> que crea un objeto de tipo <strong><code>network</code></strong>
<ul>
<li>El nombre de esta red es <strong><code>default</code></strong>.</li>
<li>Esta red es de tipo <strong><code>nat</code></strong>, el tipo de red se indica con la etiqueda <strong><code>forward</code></strong> (Esto nos permite que esta red tenga acceso al exterior, pero si queremos tener una red aislada, deberemos eliminar esta parte)</li>
<li>El dispositivo de conexión es de tipo <strong><code>bridge</code></strong>, el cual tiene un nombre llamado <strong><code>virbr0</code></strong> con el protocolo <strong><code>stp</code></strong> habilitado y el cual va a tener una ip asignada que es la <strong><code>192.168.122.1/24</code></strong></li>
<li>En nuestra subred vamos a ejecutar un servidor <strong><code>dhcp</code></strong> con <strong><code>dnsmasq</code></strong> el cual va a tener un rango para repartir IPs desde la <strong><code>192.168.122.2</code></strong> hasta la <strong><code>192.168.122.254</code></strong></li>
</ul>
</li>
</ul>
<p>Si no estamos seguros de si al fichero xml le falta algún elemento o no está bien estructurado o tiene algún error, podemos usar el comando <code>virt-xml-validate</code> para verificar que todo está correcto.</p>
<pre><code>virt-xml-validate red1.xml
red1.xml validates
</code></pre><p>Ahora vamos a crear dicha red a partir de este fichero <code>xml</code></p>
<pre><code>virsh -c qemu:///system net-create red1.xml
</code></pre><p>Si queremos ver la red que acabamos de crear</p>
<pre><code>virsh -c qemu:///system net-list
 Name      State    Autostart   Persistent
--------------------------------------------
 default   active   no          no
</code></pre><p>Si queremos ver todas las redes definidas, aunque no esté activas</p>
<pre><code>virsh -c qemu:///system net-list --all
 Name      State    Autostart   Persistent
--------------------------------------------
 default   active   no          no
</code></pre><p>La red que hemos creado, como podemos ver en el <code>net-list</code>, dice que no es persistente, esto quiere decir que cuando reiniciemos nuestra máquina, dicha red va a desaparecer. Podemos comprobar esto <em>destruyendo</em> nuestra red y ejecutando el comando <code>net-list --all</code>, para ver que no está definida en ningún sitio.</p>
<pre><code>virsh -c qemu:///system net-destroy default
Network default destroyed

 virsh -c qemu:///system net-list --all
 Name   State   Autostart   Persistent
----------------------------------------
</code></pre><p>Para crear una red que sea persistente deberemos usar el comando <code>net-define</code></p>
<pre><code>virsh -c qemu:///system net-define red1.xml
Network default defined from red1.xml

virsh -c qemu:///system net-list
 Name   State   Autostart   Persistent
----------------------------------------
</code></pre><p>Como podemos ver, si hacemos un <code>net-define</code> y después un <code>net-list</code> la red no está activa, pero si ejecutamos un <code>net-list --all</code>, podremos ver que dicha red está definida pero inactiva</p>
<pre><code>virsh -c qemu:///system net-list --all
 Name      State      Autostart   Persistent
----------------------------------------------
 default   inactive   no          yes
</code></pre><p>Para activar dicha red, deberemos hacer un <code>net-start</code></p>
<pre><code>virsh -c qemu:///system net-start default
Network default started

 virsh -c qemu:///system net-list
 Name      State    Autostart   Persistent
--------------------------------------------
 default   active   no          yes
</code></pre><p>Si queremos eliminar una red definida debemos usar el comando <code>net-undefine</code></p>
<pre><code>virsh -c qemu:///system net-undefine default
</code></pre><p>Por otro lado, vamos a comparar el directorio <code>/etc/libvirt/qemu/networks/</code> antes y después de la definición de nuestra red, ya que antes de definir nuestra red, o solo creándola, nos damos cuenta de que en dicho directorio solo hay un directorio vacío llamado <code>autostart</code></p>
<pre><code>tree /etc/libvirt/qemu/networks/
/etc/libvirt/qemu/networks/
└── autostart

1 directory, 0 files
</code></pre><p>Mientras que si defnimos una red, dicho directorio se encontraría con nuestro fichero xml en su interior.</p>
<pre><code>tree /etc/libvirt/qemu/networks/
/etc/libvirt/qemu/networks/
├── autostart
└── default.xml

1 directory, 1 file
</code></pre><p>Si queremos que nuestra red, además de ser persistente, se arranque por defecto cada vez que nosotros arranquemos nuestra máquina, deberemos hacer un <code>net-autostart</code>, entonces la API crea un enlace simbólico del fichero xml que se ha copiado en <code>/etc/libvirt/qemu/networks/</code> hacia el directorio <code>/etc/libvirt/qemu/networks/autostart</code> ya mencionado anteriormente.</p>
<pre><code>virsh -c qemu:///system net-autostart default
Network default marked as autostarted

virsh -c qemu:///system net-list
 Name      State    Autostart   Persistent
--------------------------------------------
 default   active   yes         yes

ls -l /etc/libvirt/qemu/networks/autostart/
total 0
lrwxrwxrwx 1 root root 38 mar 10 12:04 default.xml -&gt; /etc/libvirt/qemu/networks/default.xml
</code></pre><h3 id="algunos-comandos-de-redes-interesantes">Algunos comandos de redes interesantes</h3>
<ul>
<li>Saber el <code>UUID</code> de una red a partir de su nombre:</li>
</ul>
<pre><code>virsh -c qemu:///system net-uuid default
6e0958c0-12a5-4518-b369-9feeced12d08
</code></pre><ul>
<li>Saber el nombre de una red a partir de su <code>UUID</code>:</li>
</ul>
<pre><code>virsh -c qemu:///system net-name 6e0958c0-12a5-4518-b369-9feeced12d08
default
</code></pre><ul>
<li>Información de la red</li>
</ul>
<pre><code>virsh -c qemu:///system net-info default
Name:           default
UUID:           6e0958c0-12a5-4518-b369-9feeced12d08
Active:         yes
Persistent:     yes
Autostart:      yes
Bridge:         virbr0
</code></pre><h2 id="creación-de-pool-por-defecto">Creación de pool por defecto</h2>
<p><code>Pool</code> es el término que usa <code>libvirt</code> para referirse a los sistemas de almacenamiento que podemos tener en los sistemas de virtualización.</p>
<p>Para poder definir un pool, necesitamos definir otro objeto con otro fichero xml, como por ejemplo este:</p>
<pre><code>&lt;pool type='dir'&gt;
 &lt;name&gt;default&lt;/name&gt;
 &lt;target&gt;
  &lt;path&gt;/libvirt/pool1&lt;/path&gt;
 &lt;/target&gt;
&lt;/pool&gt;
</code></pre><ul>
<li>Tenemos un fichero <code>xml</code> que crea un objeto de tipo <code>pool</code> de tipo <code>dir</code> (directorio)
<ul>
<li>El cual se llama <code>default</code></li>
<li>Y está ubicado en <code>/libvirt/pool1</code></li>
</ul>
</li>
</ul>
<p>Para listar los dispositivos de almacenamiento que tenemos tanto activos como inactivos haremos lo mismo que para listar las redes, ya que el modo de empleo es el mismo.</p>
<p>Si queremos crear un <code>pool</code> usamos el comando <code>pool-create</code>, si lo queremos definir usamos <code>pool-define</code>, si lo queremos activar usamos <code>pool-start</code> y si lo queremos activar cada vez que arranque el sistema usamos <code>pool-autostart</code>.</p>
<pre><code>virsh -c qemu:///system pool-create pool1.xml
Pool default created from pool1.xml

virsh -c qemu:///system pool-define pool1.xml
Pool default defined from pool1.xml

virsh -c qemu:///system pool-start default
Pool default started

virsh -c qemu:///system pool-autostart default
Pool default marked as autostarted
</code></pre><p>Si queremos listar los <code>pools</code> de almacenamiento activos usaremos el comando <code>pool-list</code> y si queremos listar todos los <code>pools</code>, tanto los activos como los inactivos usaremos <code>pool-list --all</code>.</p>
<pre><code>virsh -c qemu:///system pool-list
 Name      State    Autostart
-------------------------------
 default   active   yes

virsh -c qemu:///system pool-list --all
 Name      State    Autostart
-------------------------------
 default   active   yes
</code></pre><p>El directorio equivalente a <code>/etc/libvirt/qemu/networks/</code> es <code>/etc/libvirt/storage</code> en el cual se copia el fichero xml que hemos creado para definir el objeto y en el directorio <code>/etc/libvirt/storage/autostart</code> se encuentra el enlace simbólico de autoarranque del pool.</p>
<pre><code>tree /etc/libvirt/storage/
/etc/libvirt/storage/
├── autostart
│   └── default.xml -&gt; /etc/libvirt/storage/default.xml
└── default.xml

1 directory, 2 files
</code></pre><p>Cuando hemos definido un pool, a parte de poder ver el fichero xml que se ha copiado en <code>/etc/libvirt/storage</code>, podemos usar el comando <code>pool-dumpxml</code> para ver el fichero que se ha generado/copiado en dicho directorio.</p>
<pre><code>virsh -c qemu:///system pool-dumpxml default
&lt;pool type='dir'&gt;
  &lt;name&gt;default&lt;/name&gt;
  &lt;uuid&gt;12554be7-613e-4603-ab87-ffcfbc249b22&lt;/uuid&gt;
  &lt;capacity unit='bytes'&gt;107321753600&lt;/capacity&gt;
  &lt;allocation unit='bytes'&gt;140763136&lt;/allocation&gt;
  &lt;available unit='bytes'&gt;107180990464&lt;/available&gt;
  &lt;source&gt;
  &lt;/source&gt;
  &lt;target&gt;
    &lt;path&gt;/libvirt/pool1&lt;/path&gt;
    &lt;permissions&gt;
      &lt;mode&gt;0755&lt;/mode&gt;
      &lt;owner&gt;1000&lt;/owner&gt;
      &lt;group&gt;1000&lt;/group&gt;
    &lt;/permissions&gt;
  &lt;/target&gt;
&lt;/pool&gt;
</code></pre><p>Si queremos eliminar un pool definido, deberemos usar la misma opción que para las redes, el comando <code>pool-undefine</code></p>
<pre><code>virsh -c qemu:///system pool-undefine default
</code></pre><h3 id="definiendo-un-pool-con-qemusession">Definiendo un pool con qemu:///session</h3>
<p>Ahora vamos a crear un <code>pool</code> de almacenamiento con <code>qemu:///session</code>. Este es el fichero xml</p>
<pre><code>&lt;pool type='dir'&gt;
  &lt;name&gt;default&lt;/name&gt;
  &lt;target&gt;
    &lt;path&gt;/home/juanan/.config/libvirt/storage&lt;/path&gt;
  &lt;/target&gt;
&lt;/pool&gt;
</code></pre><ul>
<li>Tenemos un fichero xml que define un objeto <code>pool</code> de tipo <code>dir</code> (directorio)
<ul>
<li>Se llama <code>default</code></li>
<li>Y se almacena en el directorio predeterminado para los <code>pools</code> de <code>qemu:///session</code>, que se encuentra en un directorio oculto dentro del directorio <code>/home/usuario</code> y cuyo directorio tiene la misma estructura que tenemos en el directorio <code>/etc/libvirt</code></li>
</ul>
</li>
</ul>
<p>La manera de definir los <code>pools</code> se almacenamiento de <code>qemu:///session</code> es exactamente la misma que cuando los creamos con <code>qemu:///system</code>, pero en este caso no es necesario poner <code>qemu:///session</code>, por lo que con solo ejecutar <code>virsh pool-create [fichero_xml]</code> podemos ejecutar la instrucción.</p>
<h2 id="manejo-de-volúmenes-con-virsh">Manejo de volúmenes con virsh</h2>
<p>Anteriormente hemos creado un pool de almacenamiento en la ruta <code>/libvirt/pool1</code>, el cual es un directorio. Ahora, en dicho directorio, vamos a crear un volúmen, el cual es un fichero que no sva a servir como dispositivo de almacenamiento de una máquina virtual, para realizar esto, vamos a volver a definir otros objetos con ficheros xml:</p>
<pre><code>&lt;volume type='file'&gt;
  &lt;name&gt;vol1&lt;/name&gt;
  &lt;key&gt;/libvirt/pool1/vol1.img&lt;/key&gt;
  &lt;source&gt;
  &lt;/source&gt;
  &lt;allocation&gt;0&lt;/allocation&gt;
  &lt;capacity unit=&quot;G&quot;&gt;10&lt;/capacity&gt;
  &lt;target&gt;
    &lt;path&gt;/libvirt/pool1/vol1.img&lt;/path&gt;
    &lt;format type='qcow2'/&gt;
  &lt;/target&gt;
&lt;/volume&gt;
</code></pre><ul>
<li>En este caso tenemos un fichero xml que define un objeto de tipo <code>volumen</code>, el cual es un fichero (tipo <code>file</code>)
<ul>
<li>Su nombre es <code>vol1</code></li>
<li>Tiene una capacidad de <code>10G</code>, aunque le hemos dicho que ocupe lo menos posible en función dle formato que tenga (etiqueta <code>&lt;allocation&gt;0&lt;/allocation&gt;</code>)</li>
<li>Usaremos un tipo de fichero <code>qcow2</code>, el cual permite no ocupar los 10G de imagen en nuestro disco duro.</li>
<li>La ruta hacia el fichero que se va a crear será <code>/libvirt/pool1/vol1.img</code></li>
</ul>
</li>
</ul>
<p>Ahora que tenemos el fichero de configuración de nuestro volúmen, vamos a cerarlo, para ello deberemos tener, anteriormente, un pool creado.</p>
<pre><code>virsh -c qemu:///system vol-create default vol1.xml
Vol vol1 created from vol1.xml
</code></pre><p>Como podemos ver, si hacemos este comando con el fichero de configuración previamente creado, se nos creará nuestro columen en el pool indicado, si vemos el contenido del directorio <code>/libvirt/pool1</code>, vemos que se nos ha creado un archivo llamado <code>vol1</code> y si le preguntamos el tipo con el comando <code>file</code> nos dirá que es de tipo <code>qcow2</code></p>
<pre><code>ls pool1
vol1

sudo file pool1/vol1
pool1/vol1: QEMU QCOW Image (v2), 10737418240 bytes
</code></pre><p><code>QEMU</code> tiene un comando para describir ficheros, si lo usamos nos dará información más detallada sobre el volumen creado</p>
<pre><code>sudo qemu-img info pool1/vol1
image: pool1/vol1
file format: qcow2
virtual size: 10G (10737418240 bytes)
disk size: 196K
cluster_size: 65536
Format specific information:
    compat: 0.10
    refcount bits: 16
</code></pre><p>En la información que nos da el resultado del comando <code>qemu-img info</code> nos dice que nuestra imagen es <code>qcow2</code>, que tiene un tamaño virtual de <code>10G</code>, pero que en nuestro disco duro ocupa <code>196K</code>, ya que el <code>allocation</code> lo hemos dejado a 0. Esto tiene ciertas ventajas y desventajas:</p>
<ul>
<li>
<p><strong>Ventaja de dejar <code>allocation</code> a 0:</strong> Ocupa menos espacio en el disco, es decir, ocupa solo el tamaño que necesita.</p>
</li>
<li>
<p><strong>Desventaja de dejar <code>allocation</code> a 0:</strong> La escritura en dicho volumen es más lenta, ya que tiene que estar aumentando el tamaño cada vez que se va a escribir algo.</p>
</li>
<li>
<p><strong>Ventaja de tener un <code>allocation</code> mayor que 0:</strong> La escritura en el volumen es más rápida, ya que si parte de un tamaño inicial, las primeras escrituras no tienen que aumentar el tamaño del volúmen.</p>
</li>
<li>
<p><strong>Desventajas de tener un <code>allocation</code> mayor que 0:</strong> Ocupa inicialmente más tamaño en el disco duro estando el volumen totalmente vacío.</p>
</li>
</ul>
<p>Vamos a crear otro volumen, pero esta vez de tipo <code>raw</code>, esto es un formato que no admite el <code>allocation</code> 0, es decir, que el tamaño del fichero va a ser el tamaño que este tenga</p>
<pre><code>&lt;volume type='file'&gt;
  &lt;name&gt;vol2&lt;/name&gt;
  &lt;key&gt;/libvirt/pool1/vol2.img&lt;/key&gt;
  &lt;source&gt;
  &lt;/source&gt;
  &lt;allocation&gt;0&lt;/allocation&gt;
  &lt;capacity unit=&quot;G&quot;&gt;5&lt;/capacity&gt;
  &lt;target&gt;
    &lt;path&gt;/libvirt/pool1/vol2.img&lt;/path&gt;
    &lt;format type='raw'/&gt;
  &lt;/target&gt;
&lt;/volume&gt;
</code></pre><pre><code>virsh -c qemu:///system vol-create default vol2.xml
Vol vol2 created from vol2.xml

sudo file pool1/vol2
pool1/vol2: data

sudo qemu-img info pool1/vol2
image: pool1/vol2
file format: raw
virtual size: 5.0G (5368709120 bytes)
disk size: 0
</code></pre><p>Como podemos ver en los resultados de los comando anteriores, el volumen <code>vol2</code> ocupa los 5G que nosotros le hemos asignado aunque le hayamos puesto el <code>allocation</code> a 0, pero como hemos dicho antes, el formato <code>raw</code> no lo admite así que este lo ignora.</p>
<h3 id="redimensionar-un-volumen">Redimensionar un volumen</h3>
<p>Una vez que hemos creado un volumen, podemos cambiar su tamaño si el dispositivo de almacenamiento no se está usando, para ello usaremos el comando <code>vol-resize</code>.</p>
<pre><code>virsh -c qemu:///system vol-resize vol1 12G --pool default --shrink
Size of volume 'vol1' successfully changed to 12G
</code></pre><ul>
<li>Sintaxis: <code>vol-resize [volumen] [tamaño] --pool [pool] --shrink(comprimir el tamaño lo máximo posible)</code></li>
</ul>
<p>Si le hemos aunqmentado el tamaño,m lo podemos comprobar con el comando <code>qemu-img info</code></p>
<pre><code>sudo qemu-img info pool1/vol1
image: pool1/vol1
file format: qcow2
virtual size: 12G (12884901888 bytes)
disk size: 200K
cluster_size: 65536
Format specific information:
    compat: 0.10
    refcount bits: 16
</code></pre><p>Ahora el volumen tiene disponibles <code>12GB</code>, pero soo ocupa <code>200K</code></p>
<h3 id="comandos-interesantes-de-volúmenes">Comandos interesantes de volúmenes</h3>
<ul>
<li><strong><code>vol-clone</code>:</strong> Clonar el dispositivo de almacenamiento de una máquina virtual</li>
<li><strong><code>vol-download</code>:</strong> Descargar volúmenes desde el hipervisor</li>
<li><strong><code>vol-wipe</code>:</strong> Eliminar información sin dejar rastro de lo que pudiese haber en ese volumen.</li>
<li><strong><code>vol-list --pool [pool]</code>:</strong> Listar todos los volúemenes que pertenecen a un pool en concreto.</li>
<li><strong><code>vol-delete</code>:</strong> Eliminar un volumen.</li>
</ul>
<h2 id="definición-de-un-dominio-con-virsh">Definición de un dominio con virsh</h2>
<p>Ahora vamos a ver la creación de dominios (es como se le llaman a las máquinas virtuales) con <code>virsh</code>.</p>
<ul>
<li>Listar los dominios:</li>
</ul>
<pre><code>virsh -c qemu:///system list
 Id   Name   State
--------------------

virsh -c qemu:///system list --all
 Id   Name   State
--------------------
</code></pre><p>Para definir los dominios deberesmo crear otro fichero xml como en los anteriores casos</p>
<pre><code>&lt;domain type=&quot;kvm&quot;&gt;
  &lt;name&gt;dominio1&lt;/name&gt;
  &lt;memory unit=&quot;G&quot;&gt;1&lt;/memory&gt;
  &lt;vcpu&gt;1&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch=&quot;x86_64&quot;&gt;hvm&lt;/type&gt;
  &lt;/os&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;source file='/libvirt/pool1/vol1'/&gt;
      &lt;target dev='vda'/&gt;
    &lt;/disk&gt;
    &lt;interface type=&quot;network&quot;&gt;
      &lt;source network=&quot;default&quot;/&gt;
      &lt;mac address=&quot;52:54:00:86:c6:a9&quot;/&gt;
    &lt;/interface&gt;
    &lt;console&gt;
      &lt;target type='serial'/&gt;
    &lt;/console&gt;
  &lt;/devices&gt;
&lt;/domain&gt;
</code></pre><ul>
<li>Tenemos un fichero xml que crea un objeto tipo dominio y que usa la virtualización de <code>kvm</code>, este se llama <code>dominio1</code>.
<ul>
<li>Tiene <code>1GB</code> de memoria RAM.</li>
<li>Tiene <code>1 core virtual</code>.</li>
<li>Se especifica que vamos a usar una arquitectura x86 y especificamos que es una <code>hvm</code> (<em>Hardware Virtual Machine</em>)</li>
<li>El emulador que usaremos como es <code>kvm</code>, especificamos la ruta hacia él (<code>/usr/bin/kvm</code>)</li>
<li>Le indicamos que el almacenamiento de la máquina va a ser un fichero (<code>file</code>), pero la máquina lo va a ver como si fuera un disco (<code>disk</code>).</li>
<li>Le indicamos también la ruta que tiene el archivo que vamos a usar como dispositivo de almacenamiento (el cual va a ser el volumen <code>vol1</code> que henmos creado anteriormente y está ubicado en <code>/libvirt/pool1/vol1</code>), peor en la máquina aparecerá dicho dispositivo de almacenamiento como un <code>vda</code>.</li>
<li>Le ponemos una interfaz de red conectada a la red llamada <code>default</code>, la cual hemos creado anteriormente y le ponemos una dirección MAC a dicha interfaz (dicha dirección MAC debe tener los 3 primeros octetos de libvirt y los demás aleatorios, es decir, <code>52:54:00:...</code>).</li>
<li>Le indicamos que tenemos una consola tipo serie.</li>
</ul>
</li>
</ul>
<p>Ahora creamos el dominio:</p>
<pre><code>virsh -c qemu:///system define dominio1.xml
Domain dominio1 defined from dominio1.xml
</code></pre><p>Cuando hayamos definido el dominio, se creará una copia del xml en <code>/etc/libvirt/qemu</code></p>
<pre><code>ls /etc/libvirt/qemu
dominio1.xml  networks
</code></pre><p>Si hacemos un <code>list</code>, el dominio que acabamos de definir no aparecerá, ya que no está activo todavía, pero lo podemos ver si hacemos un <code>list --all</code></p>
<pre><code>virsh -c qemu:///system list
 Id   Name   State
--------------------

virsh -c qemu:///system list --all
 Id   Name       State
---------------------------
 -    dominio1   shut off
</code></pre><p>Para crear imágenes para poder arrancar los dominios que creemos vamos a hacer uso de la herramienta <code>virtinst</code>.</p>
<h2 id="virtinst">Virtinst</h2>
<p>El paquete <code>virinst</code> contiene una serie de programas de más alto nivel que <code>virsh</code>, los cuales nos pueden ayudar a realizar determinadas tareas. Así que en lugar de interactuar con ficheros xml, vamos a interactuar con la API de <code>libvirt</code> a través de un comando en nuestra terminal.</p>
<h3 id="virt-install">virt-install</h3>
<p>Este programa se usa para la instalación inicial de una máquina virtual. Ejemplo:</p>
<ul>
<li>
<p><strong>Queremos una máquina virtual con las siguientes especificaciones:</strong></p>
<ul>
<li><strong>1 core virtual</strong></li>
<li><strong>1024 MiB de RAM</strong></li>
<li><strong>Que se conecte a la red <code>default</code> que anteriormente hemos creado</strong></li>
<li><strong>Que cree un volumen de 10GiB en el pool <code>default</code> que hemos creado anteriormente</strong></li>
<li><strong>Que use una imagen ISO netinst de debian 10 que hemos descargado</strong></li>
</ul>
</li>
</ul>
<pre><code>virt-install --connect qemu:///system \
--cdrom /libvirt/debian/debian-10.8.0-amd64-netinst.iso \
--disk size=10 \
--network bridge=virbr0 \
--name dominio1 \
--memory 1024 \
--vcpus 1
</code></pre><p>Si surge el error <code>ERROR    internal error: cannot load AppArmor profile 'libvirt-...'</code> deberemos de editar el fichero <code>/etc/libvirt/qemu.conf</code> y descomentamos la línea <code>416</code> y cmabiamos su valor a <code>none</code> y reiniciamos el servicio de <code>libvirt</code></p>
<pre><code>sudo nano /etc/libvirt/qemu.conf
[...]
security_driver = &quot;none&quot;
[...]
</code></pre><ul>
<li>Para ver la pantalla de un dominio</li>
</ul>
<pre><code>virt-viewer -c qemu:///system [nombre del dominio]
</code></pre><h2 id="creación-de-una-red-nat-desde-fichero-xml">Creación de una red NAT desde fichero XML</h2>
<p>Crear redes desde cero en formato xml como hemos hecho anteriormente es un poco complicado de primeras, pero si usamos las herramientas adecuadas, puede ser un poco más fácil la tarea. Para hacer una red de tipo <code>NAT</code> con un fichero xml desde cero, vamos a usar las siguientes herramientas para ayudarnos:</p>
<ul>
<li><a href="https://libvirt.org/format.html">Documentación de libvirt</a></li>
<li>Editor de texto <code>emacs</code> con el modo xml activo</li>
<li><a href="https://github.com/libvirt/libvirt.git">Repositorio de libvirt</a> con los esquemas para cargarle al editar <code>emacs</code></li>
<li><code>trang</code> para convertir ficheros</li>
</ul>
<p>Sabiendo las herramientas que vamos a usar, vamos a comenzar por instalar el editor de texto (si no lo tenemos) y a clonar el repositorio</p>
<pre><code>sudo apt-get install emacs

git clone https://github.com/libvirt/libvirt.git
</code></pre><p>En el interior del repositorio que acabamos de clonar hay una carpeta llamada <code>docs/schemas/</code> en la cual se encuentran los esquemas que hay que seguir para realizar los fichero xml de configuración. Estos archivos de esquema están en formato <code>rng</code>, pero el editor <code>emacs</code> solo admite <code>rnc</code> (un formato más comprimido que <code>rng</code>), así que convertiremos el archivo <code>network.rng</code> en <code>network.rnc</code> con la herramienta <code>trang</code></p>
<pre><code>trang -I rng -O rnc network.rng network.rnc

ls -hrtl
[...]
-rw-r--r-- 1 juanan juanan 5,6K mar 17 17:15 network.rnc
-rw-r--r-- 1 juanan juanan 2,8K mar 17 17:15 networkcommon.rnc
-rw-r--r-- 1 juanan juanan 9,0K mar 17 17:15 basictypes.rnc
</code></pre><p>Como podemos ver, se han creado tres ficheros, uno de ellos el fichero <code>network.rnc</code> y los otros dos son dependencias que necesita el fichero ya mencionado.</p>
<p>Ahora pasaremos a crear el fichero xml, para ello, como hemos dicho anteriormente, usaremos <code>emacs</code></p>
<pre><code>emacs red1.xml
</code></pre><p>Cuando tengamos nuestro editor arrancado, vamos a cargarle los esquemas necesarios, para ello nos dirigimos a <code>XML --&gt; Set Schema --&gt; File</code> y seleccionamos nuestro archivo <code>network.rnc</code></p>
<p>Otro dato es que si queremos generar un <code>UUID</code> aleatorio para crear nuestra red, lo podemos hacer de la siguiente manera</p>
<pre><code>cat /proc/sys/kernel/random/uuid
</code></pre><p>Si queremos una dirección MAC aleatoria con los tres primeros octetos del fabricante de libvirt, ejecutamos el siguiente comando</p>
<pre><code>openssl rand -hex 3 | sed 's/\(..\)\(..\)\(..\)/52:54:00:\1:\2:\3/'
</code></pre>
      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://juanan219.github.io/tags/apuntes/">Apuntes</a></span>
        <span class="tag"><a href="https://juanan219.github.io/tags/documentacion/">Documentacion</a></span>
        <span class="tag"><a href="https://juanan219.github.io/tags/libvirt/">Libvirt</a></span>
        <span class="tag"><a href="https://juanan219.github.io/tags/virsh/">virsh</a></span>
        <span class="tag"><a href="https://juanan219.github.io/tags/virtinst/">virtinst</a></span>
        <span class="tag"><a href="https://juanan219.github.io/tags/kvm/">kvm</a></span>
        <span class="tag"><a href="https://juanan219.github.io/tags/qemu/">qemu</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        3001 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          18183-18-00 33:10
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Apuntes%20de%20Libvirt&amp;caption=Apuntes%20de%20Libvirt&amp;canonicalUrl=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Apuntes%20de%20Libvirt&amp;body=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f&amp;media=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f;description=Apuntes%20de%20Libvirt" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f&amp;title=Apuntes%20de%20Libvirt&amp;summary=Apuntes%20de%20Libvirt&amp;source=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f&amp;resubmit=true&amp;title=Apuntes%20de%20Libvirt" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f;title=Apuntes%20de%20Libvirt" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Apuntes%20de%20Libvirt%20https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f&amp;t=Apuntes%20de%20Libvirt" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Apuntes%20de%20Libvirt&amp;url=https%3a%2f%2fjuanan219.github.io%2fposts%2f2021%2f03%2fapuntes-de-libvirt%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://juanan219.github.io/posts/2021/04/metricas-logs-y-monitorizacion/">
                <span class="button__icon">←</span>
                <span class="button__text">Metricas logs y monitorizacion</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="https://juanan219.github.io/posts/2021/03/practica-vpn/">
                <span class="button__text">Practica VPN</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            <span><a href="https://juanan219.github.io">Juan antonio Reifs</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span><span><a href="https://juanan219.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://juanan219.github.io/bundle.min.af435e44374f1e99a669ea8cd5bb9a2fceed80588941a451bfddb66b86a67c9f40b0f417e9543a763f809aa7e9300d7b1d69bf99615810ba02ac70396d50fad5.js" integrity="sha512-r0NeRDdPHpmmaeqM1buaL87tgFiJQaRRv922a4amfJ9AsPQX6VQ6dj&#43;AmqfpMA17HWm/mWFYELoCrHA5bVD61Q=="></script>



    </body>
</html>
